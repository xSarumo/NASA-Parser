[![Open in Visual Studio Code](https://classroom.github.com/assets/open-in-vscode-2e0aaae1b6195c2367325f4f02e2d04e9abb55f0b24a779b69b11b9e10269abc.svg)](https://classroom.github.com/online_ide?assignment_repo_id=16012449&assignment_repo_type=AssignmentRepo)
# Лабораторная работа 1

## Задача

Реализовать [утилиту](https://ru.wikipedia.org/wiki/%D0%A3%D1%82%D0%B8%D0%BB%D0%B8%D1%82%D0%B0), производящую анализ [access.log](https://ru.wikipedia.org/wiki/Access.log).


На основании данного лога утилита должна уметь:

1. Выводить запросы, которые завершились ошибкой (с кодом `5XX`).

2. Находить промежуток времени, в который количество запросов к серверу было максимальным.


### Аргументы программы

Утилита должна поддерживать следующие аргументы командной строки (опции):

| Короткий аргумент | Длинный аргумент  | Значение по умолчанию   | Описание |
|-------------------|-------------------|-------------------------|----------|
| `-o path`         | `--output=path`   |                         | Путь к файлу, в который будут записаны запросы с ошибками. Если файл не указан, анализ запросов с ошибками не выполняется. |
| `-p`              | `--print`         |                         | Продублировать вывод запросов с ошибками в `stdout` (стандартный поток вывода / терминал) |
| `-s n`            | `--stats=n`       | `10`                    | Вывести `n` самых частых запросов, завершившихся со статус кодом `5XX` в порядке их частоты. |
| `-w t`            | `--window=t`      | `0`                     | Найти и вывести промежуток (окно) времени длительностью t секунд, в которое количество запросов было максимально. Eсли t равно 0, расчет не производится. |
| `-f`              | `--from=time`     | Наименьшее время в логе | Время в формате [timestamp](https://www.unixtimestamp.com), начиная с которого происходит анализ данных. |
| `-е`              | `--to=time`       | Наибольшее время в логе | Время в формате [timestamp](https://www.unixtimestamp.com), до которого происходит анализ данных (включительно) |

Название файла и опции передаются программе в виде аргументов командной строки в следующем формате:

```
AnalyzeLog [OPTIONS] logs_filename
```

### Формат файла логов

В качестве примера файла логов, предлагается использовать [логи сервера NASA](https://drive.google.com/file/d/1jjzMocc0Rn9TqkK_51Oo93Fy78KYnm2i/view).

Логи представляют из себя текстовый файл, где каждая строка содержит событие доступа к сереру в следующем формате:

`<remote_addr> - - [<local_time>] "<request>" <status> <bytes_send>`

| Значение     | Описание                                |
|--------------|-----------------------------------------|
| `remote_addr`| Адрес, с которого был отправлен запрос. |
| `local_time` | Время, в которое был получен запрос.    |
| `request`    | URL запроса.                            |
| `status`     | [Код ответа сервера](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status). |
| `bytes_send` | Количество переданных в ответе байт.    |

Пример строк из файла логов:

```
198.112.92.15 - - [03/Jul/2024:10:50:02 -0400] "GET /shuttle/countdown/HTTP/1.0" 200 3985
198.112.92.15 - - [03/Jul/2024:10:50:04 -0400] "GET /shuttle/nosuchpath/HTTP/1.0" 404 144
```

### Примеры запуска программы:

```
AnalyzeLog access.log --output=result.txt
```

```
AnalyzeLog access.log --output=result.txt --print --stats 5
```

```
AnalyzeLog --stats=2 --window=60 --from=805821284 --to=807117284 access.log
```

```
AnalyzeLog -s 2 access.log
```

```
AnalyzeLog -w 10 access.log
```

```
AnalyzeLog access.log -w 10
```

## Рекомендации

- Стоит подумать, что размер файла может быть достаточно большим, и значительно превышать объем доступной оперативной памяти. Поэтому, потребление оперативной памяти не должно зависеть от размера файла.

- Стоит подумать, каким образом можно разбить программу на логичные функции.

- Не забывайте про кодстайл.

## Дополнительная информация

Для реализации утилиты потребуется воспользоваться [стандартной библиотекой ввода/вывода](https://en.cppreference.com/w/cpp/io/basic_ifstream). [Пример использования](https://cplusplus.com/doc/tutorial/files/).

С примером того, как можно организовать парсинг аргументов командной строки, можно ознакомиться [здесь](http://www.cplusplus.com/articles/DEN36Up4/).

## Ограничения

Внешние библиотеки запрещены. Разрешается пользоваться только стандартной библиотекой С или С++.

## Deadlines

1. 01.10.23 24:00 - 0.8
2. 08.10.23 24:00 - 0.65
3. 15.10.23 24:00 - 0.5
